<html>
<head>
  <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
  <%= stylesheet_link_tag "/css/annotorious.css" %>
  <style>
    body {
      color: #242424;
      font-size: 14px;
      font-family: 'Helvetica Neue', Arial, sans-serif;
    }
    .picture {
      border: 3px;
      padding: 10px 10px 0px 10px;
    }
    a {
      text-decoration: none;
      color: #242424;
    }
    a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body onload="iframeResizePipe()">
  <iframe id="helpframe" src='' height='0' width='0' frameborder='0'></iframe>
  <div class="span6 item">
    <div class="picture">
      <%= image_tag(@photo.file.url(:full), width: '100%', id: 'photo', class: 'photo annotatable') %>

      <%= render 'shared/photo_footer', photo: @photo, external_link: true %>
    </div>  
  </div>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <%= javascript_include_tag "/javascripts/jquery.imagesloaded.js" %>
  <%= render 'shared/annotorious', photo: @photo %>

  <script>
  // http://stackoverflow.com/questions/153152/resizing-an-iframe-based-on-content
  function iframeResizePipe() {
     var height = document.body.scrollHeight;

     // Going to 'pipe' the data to the parent through the helpframe..
     var pipe = document.getElementById('helpframe');

     // Cachebuster a precaution here to stop browser caching interfering
     pipe.src = 'http://localhost:3000/helper.html?height='+height+'&cacheb='+Math.random();

  }
  </script>

</body>
</html>